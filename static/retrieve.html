<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="/static/assets/css/dp19styles.css">

    <script src="/static/libs/p5.min.js"></script>
    <script src="/static/libs/three.min.js"></script>
    <script src="/static/libs/OrbitControls.js"></script>
    <script src="/static/libs/OBJLoader.js"></script>
    <script src="/static/libs/MTLLoader.js"></script>
</head>

<body>
    <div id="header">
        <table width=1220px>
            <tr>
                <td style="text-align:left; font-family:Arial, Helvetica, sans-serif; font-size:32px; font-weight:bold"
                    width=85%> &nbsp My Project </td>
                <td width=5%> <a href="/"><img src="\static\assets\img\home.png"></a> </td>
                <td width=5%> <a href="/draw"><img src="\static\assets\img\draw.png"></a></td>
                <td width=5%> <a href="/help"><img src="\static\assets\img\help.png"></a> </td>
            </tr>
        </table>
    </div>
    <div id="container" style="margin-top:2%">
        <script src="/static/js/global.js"></script>

        <h1>Retrieve Data</h1>
        SELECT OPTION TO DISPLAY
        <select id="select"> </select>
        <br>
        <div id="3D" style="margin-top:5%"></div>
        <script>
            var jsonArr = [];
            var filenames = [];
            var meshArr = [];
            var div3D, camera3D, scene3D, controls, light, renderer;
            var meshArr = [];


            // Fetch retrieve data from API
            fetch('/api/retrieve-data')
                .then(response => response.json())
                .then(data => {
                    var dataArr = data.split('|');
                    for (var i = 0; i < dataArr.length - 1; i++) {
                        var arr = dataArr[i].split('-');
                        var id = arr[0];
                        if (i > 0) id = arr[0].split(',')[1];
                        var filename = arr[1];
                        var type = arr[2];
                        var coords = arr[3];
                        json = {
                            id: id,
                            name: filename,
                            type: type,
                            coords: coords
                        };
                        str = JSON.stringify(json);
                        jsonArr.push(json);
                        var sum = 0;
                        for (var j = 0; j < filenames.length; j++) {
                            if (filenames[j] === filename) sum++;
                        }
                        if (sum === 0) filenames.push(filename);
                    }
                    var selObj = document.getElementById("select");
                    for (var i = 0; i < filenames.length; i++) {
                        selObj.options[i] = new Option(filenames[i], i);
                    }
                })
                .catch(error => console.error('Error loading retrieve data:', error));
        </script>

        <script src="/static/js/retrieve.js"></script>

        <script>
            var m = new THREE.MeshPhongMaterial({ color: 0x1a2eff, opacity: 0.75, transparent: true, side: THREE.DoubleSide });
            
            var chair;
            
            setup3D();
            setInterval(retdraw, 100);
        </script>
    </div>
</body>

</html>
